<!--index/wave-player.wxml-->

<view class="wave-player">
    <view class="player-item play-wave-charts" wx:if="{{showCharts}}">
        <chart chart-class="chart" model:option="{{ waveChartsOpt }}" bindinstance="onInstance" width="100%" height="100%" />
    </view>
    <view class="player-item">
        <view class="player-item-btns">
            <view class="player-item-btns-text">
                <text class="player-text" bind:tap="showPlayTypePop">{{playTypeStr}}</text>
            </view>
            <view>
                <van-popup show="{{ showPlayType }}" position="bottom">
                    <van-picker default-index="{{playType}}" show-toolbar title="播放类型" columns="{{ playTypeList }}" value-key="text" bind:confirm="onPlayTypeChange" bind:cancel="closePlayTypePop" />
                </van-popup>
                <van-icon class="btn-player-item" name="arrow-left" bindtap="prev" />
                <van-button round type="primary" bindtap="togglePlay" class="btn-player" icon="play" data-channel="{{channel}}" wx:if="{{!invWorker.isRunning}}"></van-button>
                <van-button round type="primary" bindtap="togglePlay" class="btn-player" icon="stop" data-channel="{{channel}}" wx:if="{{invWorker.isRunning}}"></van-button>
                <van-icon class="btn-player-item" name="arrow" bindtap="next" />
            </view>
            <view class="player-item-btns-text">
                <text class="player-text" bind:tap="toggleWaveCharts" wx:if="{{!showCharts}}">显示图像</text>
                <text class="player-text" bind:tap="toggleWaveCharts" wx:if="{{showCharts}}">关闭图像</text>
            </view>
        </view>
    </view>

    <view class="player-item">
        <view class="player-item">电源强度 <a bindtap="showPwHelp">
                <van-icon name="question" />
            </a><text>：{{pw}}</text></view>
        <van-row gutter="10">
            <van-col span="6">
                <van-button icon="minus" class="mini-btn" type="default" size="mini" bindtap="subAp" bindlongpress="subLongAp" bindtouchend="endSubLongAp"></van-button>
            </van-col>
            <van-col span="12">
                <van-slider class="player-pw-slider" binddrag="apChange" min="0" max="2047" value="{{pw}}" show-value />
            </van-col>
            <van-col span="6">
                <van-button icon="plus" class="mini-btn" type="default" size="mini" bindtap="addAp" bindlongpress="addLongAp" bindtouchend="endLongAp"></van-button>
            </van-col>
        </van-row>
    </view>
    <view class="player-item">
        <view class="player-item">智能强度 <a bindtap="showAiPwHelp">
                <van-icon name="question" />
            </a></view>
        <van-switch name="aiPw" checked="{{ aiPw }}" size="1rem" bind:change="onAiPwChange" />
    </view>
    <view class="player-item">
        <view>定时输出 <a bindtap="showInvHelp">
                <van-icon name="question" />
            </a></view>
        <view class="play-item-line">
            <van-switch class="play-item-line-elem inv-stepper-switch" size="1rem" checked="{{ invEnabled }}" bind:change="onInvEnabledChange" />
            <van-stepper class="play-item-line-elem inv-stepper" min="5" value="{{ playInvTime }}" />
            <view class="play-item-line-elem  inv-stepper-text">分</view>
        </view>
    </view>
    <view class="player-item">
        <view>随机输出 <a bindtap="showRdmInvHelp">
                <van-icon name="question" />
            </a></view>
        <view class="play-item-line">
            <van-switch class="play-item-line-elem inv-stepper-switch" size="1rem" checked="{{ rdmInvEnabled }}" bind:change="onRdmInvEnabledChange" />
            <view class="play-item-line-elem  inv-stepper-text">工作</view>
            <!-- <van-stepper class="play-item-line-elem inv-stepper" min="5" value="{{ playRdmInv.wStart }}" /> -->
            <van-field class="play-item-line-elem time-input" value="{{ playRdmInv.wStart }}" type="number" />
            <view class="play-item-line-elem  inv-stepper-text">~</view>
            <van-field class="play-item-line-elem time-input" value="{{ playRdmInv.wEnd }}" type="number" />
            <view class="play-item-line-elem  inv-stepper-text">秒</view>
        </view>
        <view class="play-item-line">
            <view class="play-item-line-elem not-show"></view>
            <view class="play-item-line-elem  inv-stepper-text">暂停</view>
            <!-- <van-stepper class="play-item-line-elem inv-stepper" min="5" value="{{ playRdmInv.wStart }}" /> -->
            <van-field class="play-item-line-elem time-input" value="{{ playRdmInv.pStart }}" type="number" />
            <view class="play-item-line-elem  inv-stepper-text">~</view>
            <van-field class="play-item-line-elem time-input" value="{{ playRdmInv.pEnd }}" type="number" />
            <view class="play-item-line-elem  inv-stepper-text">秒</view>
        </view>
        <view class="player-item">
            <view class="player-item">双通道波形优先 <a bindtap="showDbChannelHelp">
                    <van-icon name="question" />
                </a></view>
            <van-switch name="dbChannel" checked="{{ dbChannel }}" size="1rem" bind:change="onDbChannelChange" />
        </view>
    </view>
    <view class="player-list-tools">
        <van-icon name="delete-o" />
    </view>
    <view class="player-item play-list h-scorller">
        <play-list play-list="{{playList || []}}" active-idx="{{playingIdx}}" bind:waveclick="onPlayWaveClick" bind:change="onPlayListChange"></play-list>
    </view>
    <van-dialog id="van-dialog" />
</view>